(this.webpackJsonpmangankyo=this.webpackJsonpmangankyo||[]).push([[0],[,,,,,,,function(e,t,a){e.exports=a(17)},,,,,function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(4),c=a.n(l),o=(a(12),a(2)),i=a.n(o),s=a(5),u=a(1),d=(a(14),a(15),function(e){var t=e.already,a=r.a.useRef(null);return r.a.useEffect((function(){var e;a.current&&t&&(null===(e=a.current)||void 0===e||e.classList.add("loaded"))})),r.a.createElement("h1",{className:"SplashScreen-h1",title:"\u4e07\u9854\u93e1",ref:a},r.a.createElement("img",{className:"SplashScreen-img-logo",alt:"\u4e07\u9854\u93e1 \u30ed\u30b4\u753b\u50cf",src:"/splash-logo.svg"}),r.a.createElement("img",{className:"SplashScreen-img-star",alt:"",role:"presentation",src:"/splash-star.svg"}))}),m=a(6),h=(a(16),function(e){var t=e.already,a=e.setScale,n=e.canvasRef,l=e.scale,c=e.download,o=r.a.useRef(null),i=r.a.useRef(null),s=r.a.useCallback((function(){var e;return null===(e=o.current)||void 0===e?void 0:e.showModal()}),[]),u=r.a.useCallback((function(){var e;return null===(e=o.current)||void 0===e?void 0:e.close()}),[]),d=r.a.useCallback((function(){var e;return a((null===(e=i.current)||void 0===e?void 0:e.valueAsNumber)||.5)}),[a]),h=r.a.useCallback(function(e,t,a){return function(n){var r;27===n.keyCode&&(n.preventDefault(),(null===(r=e.current)||void 0===r?void 0:r.open)?t():a())}}(o,u,s),[u,s]),g=r.a.useCallback(function(e){return function(){return e()}}(s),[s]);return r.a.useEffect((function(){return document.addEventListener("keydown",h,!1)}),[h]),r.a.useEffect((function(){var e;return null===(e=n.current)||void 0===e?void 0:e.addEventListener("click",g,!1)}),[g,n]),r.a.useEffect((function(){o.current&&m.a.registerDialog(o.current)}),[o]),t?r.a.createElement(r.a.Fragment,null,r.a.createElement("dialog",{className:"Settings-dialog",ref:o,style:{top:"30px",backgroundImage:"url(/splash-star.svg)"}},r.a.createElement("section",null,r.a.createElement("h2",null,"\u8a2d\u5b9a"),r.a.createElement("dl",null,r.a.createElement("dt",null,"\u30d1\u30bf\u30fc\u30f3\u306e\u5927\u304d\u3055"),r.a.createElement("dd",null,r.a.createElement("output",null,l),r.a.createElement("input",{type:"range",step:"0.1",min:"0.1",max:"2.0",value:l,ref:i,onChange:d}))),r.a.createElement("dl",null,r.a.createElement("dt",null,"\u5168\u4f53\u306e\u30ad\u30e3\u30f3\u30d0\u30b9\u753b\u50cf\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9"),r.a.createElement("dd",null,r.a.createElement("small",null,"\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u304c\u4e0a\u624b\u304f\u884c\u304b\u306a\u3044\u5834\u5408\u306f\u3001",r.a.createElement("br",null),"\u30ad\u30e3\u30f3\u30d0\u30b9\u3092",r.a.createElement("em",null,"\u30ed\u30f3\u30b0\u30bf\u30c3\u30d7/\u53f3\u30af\u30ea\u30c3\u30af"),"\u3057\u3066\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),r.a.createElement("button",{type:"button",onClick:function(){return c({type:"display"})}},"\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9")),r.a.createElement("dt",null,"\u6700\u5c0f\u5358\u4f4d\u306e\u30d1\u30bf\u30fc\u30f3\u753b\u50cf\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9"),r.a.createElement("dd",null,r.a.createElement("small",null,"\u58c1\u7d19\u306a\u3069\u306b\u5229\u7528\u3057\u3084\u3059\u3044\u3001",r.a.createElement("br",null),"\u5207\u308c\u76ee\u306e\u306a\u3044\u30b7\u30fc\u30e0\u30ec\u30b9\u306a\u30ea\u30d4\u30fc\u30c8\u7528\u6700\u5c0f\u30d1\u30bf\u30fc\u30f3\u753b\u50cf\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3067\u304d\u307e\u3059\u3002"),r.a.createElement("button",{type:"button",onClick:function(){return c({type:"pattern"})}},"\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9")))),r.a.createElement("section",null,r.a.createElement("h2",null,"\u4e07\u9854\u93e1\u306b\u3064\u3044\u3066"),r.a.createElement("dl",null,r.a.createElement("dt",null,"Source on GitHub"),r.a.createElement("dd",null,r.a.createElement("a",{href:"https://github.com/ver-1000000/mangankyo"},"mangankyo"))),r.a.createElement("dl",null,r.a.createElement("dt",null,"WebSite / Author"),r.a.createElement("dd",null,r.a.createElement("a",{href:"https://ver1000000.com"},"Ver.1000000")," / ",r.a.createElement("a",{href:"https://twitter.com/Ver1000000000"},"@Ver1000000000")))),r.a.createElement("button",{type:"button",onClick:u},"close"))):null});function g(e){if(null==e)throw alert("\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u30a8\u30e9\u30fc: \u30da\u30fc\u30b8\u3092\u518d\u8aad\u8fbc\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),new Error("Expected 'val' to be defined, but received ".concat(e))}var v=function(e){return e*Math.PI/180},f=function(e){var t=e.width,a=e.height,n=Object.assign(document.createElement("canvas"),{width:t,height:a}),r=n.getContext("2d");return[n,r]},E=function(e,t){var a=t.scale,n=Math.min(e.videoWidth,e.videoHeight)*a,r=n/2*Math.tan(v(60)),l=f({width:n,height:r}),c=Object(u.a)(l,2),o=c[0],i=c[1],s=[{x:n/2,y:0},{x:n,y:r},{x:0,y:r}],d=-Math.max(0,(e.videoWidth-e.videoHeight)/2),m=-Math.max(0,(e.videoHeight-e.videoWidth)/2);return i.save(),i.scale(a,a),i.drawImage(e,d,m,e.videoWidth,e.videoHeight),i.restore(),i.globalCompositeOperation="destination-in",i.beginPath(),i.moveTo(s[0].x,s[0].y),i.lineTo(s[1].x,s[1].y),i.lineTo(s[2].x,s[2].y),i.closePath(),i.fill(),i.globalCompositeOperation="source-over",o},p=function(e){var t=f({width:3*e.width,height:2*e.height}),a=Object(u.a)(t,2),n=a[0],r=a[1],l=function(t){var a=t.rotate,l=void 0===a?0:a,c=t.scaleX,o=void 0===c?1:c,i=t.scaleY,s=void 0===i?1:i,u=t.translateX,d=void 0===u?0:u,m=t.translateY,h=void 0===m?0:m;r.setTransform(1,0,0,1,n.width/3,n.height/2),r.rotate(v(l)),r.scale(o,s),r.translate(d,h),r.drawImage(e,-n.width/3,-n.height/2)};return l({rotate:0,scaleY:1}),l({rotate:0,scaleY:-1}),l({rotate:0,scaleY:1,translateX:1.5*e.width,translateY:e.height}),l({rotate:0,scaleY:-1,translateX:1.5*e.width,translateY:e.height}),l({rotate:120,scaleY:1}),l({rotate:120,scaleY:-1}),l({rotate:120,scaleY:1,translateX:0,translateY:2*-e.height}),l({rotate:120,scaleY:-1,translateX:0,translateY:2*e.height}),l({rotate:120,scaleY:1,translateX:1.5*e.width,translateY:e.height}),l({rotate:240,scaleY:1}),l({rotate:240,scaleY:-1}),l({rotate:240,scaleY:1,translateX:0,translateY:2*e.height}),l({rotate:240,scaleY:-1,translateX:0,translateY:2*-e.height}),l({rotate:240,scaleY:-1,translateX:1.5*e.width,translateY:e.height}),r},b=function(){var e=Object(s.a)(i.a.mark((function e(t,a){var n,r,l,c,o,s,u,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(t),n=navigator.mediaDevices.getUserMedia({audio:!1,video:!0}),e.next=4,n.catch((function(e){return alert(e.name+": "+e.message)}));case 4:r=e.sent,l=Object.assign(document.createElement("video"),{srcObject:r,onloadeddata:onloadeddata}),c=t.getContext("2d"),o=t.getBoundingClientRect(),s=o.width,u=o.height,Object.assign(t,{width:s,height:u}),d=function e(){var t=E(l,{scale:a.scale}),n=p(t);c.fillStyle=n.createPattern(n.canvas,"repeat"),c.fillRect(0,0,s,u),a.setPatternCanvas(n.canvas),requestAnimationFrame(e)},l.play().then((function(){return d()})).then((function(){return a.setAlready(!0)}));case 11:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),y=function(e,t,a){g(e),g(t);var n="display"===a.type?e:t,r=n.width,l=n.height,c=f({width:r,height:l}),o=Object(u.a)(c,2),i=o[0];o[1].drawImage(e,0,0);var s=document.createElement("a"),d=document.createElement("img");document.body.appendChild(s),document.body.appendChild(d),s.href=d.src=i.toDataURL(),s.download="mangankyo_".concat((new Date).toLocaleString("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"numeric"}).replace(/\D/g,""),".png"),s.click(),s.remove(),d.remove()},w=function(){var e=r.a.useState(!1),t=Object(u.a)(e,2),a=t[0],n=t[1],l=r.a.useState(.5),c=Object(u.a)(l,2),o=c[0],i=c[1],s=r.a.useState(null),m=Object(u.a)(s,2),g=m[0],v=m[1],f=r.a.useRef(null),E=r.a.useCallback((function(e){return y(f.current,g,e)}),[g]);return r.a.useEffect((function(){b(f.current,{scale:o,setPatternCanvas:v,setAlready:n})}),[o]),r.a.createElement(r.a.Fragment,null,r.a.createElement("canvas",{ref:f,className:"App-canvas"}),r.a.createElement(d,{already:a}),r.a.createElement(h,{className:"App-Settings",already:a,scale:o,setScale:i,download:E,canvasRef:f}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(w,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[7,1,2]]]);
//# sourceMappingURL=main.6da2fbd7.chunk.js.map