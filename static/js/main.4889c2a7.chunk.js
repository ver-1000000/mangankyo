(this.webpackJsonpmangankyo=this.webpackJsonpmangankyo||[]).push([[0],[,,,,,,,,,,,,function(e,t,a){e.exports=a(23)},,,,,function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(9),o=a.n(l),c=(a(17),a(6)),i=a.n(c),s=a(7),u=a(1),d=(a(19),a(20),function(e){var t=e.already,a=e.floatButtonsVisibled,n=e.floatButtonsDownloadMode,l=e.setSettingsVisibled,o=e.download;return t&&a?r.a.createElement(r.a.Fragment,null,r.a.createElement("ul",{className:"FloatButtons-ul"},r.a.createElement("li",null,r.a.createElement("input",{type:"image",className:"FloatButtons-button",src:"./button-download.svg",alt:"\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30dc\u30bf\u30f3",title:"\u30ad\u30e3\u30f3\u30d0\u30b9\u753b\u50cf\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9",onClick:function(){return o({mode:n})}})),r.a.createElement("li",null,r.a.createElement("input",{type:"image",className:"FloatButtons-button",src:"./button-settings.svg",alt:"\u8a2d\u5b9a\u30dc\u30bf\u30f3",title:"\u8a2d\u5b9a\u753b\u9762\u3092\u958b\u304f",onClick:function(){return l(!0)}})))):null}),m=(a(21),function(e){var t=e.already,a=r.a.useRef(null);return r.a.useEffect((function(){var e;return null===(e=a.current)||void 0===e?void 0:e.classList[t?"add":"remove"]("loaded")}),[t]),r.a.createElement("h1",{className:"SplashScreen-h1",title:"\u4e07\u9854\u93e1",ref:a},r.a.createElement("img",{className:"SplashScreen-img-logo",alt:"\u4e07\u9854\u93e1 \u30ed\u30b4\u753b\u50cf",src:"./splash-logo.svg"}),r.a.createElement("img",{className:"SplashScreen-img-star",alt:"",role:"presentation",src:"./splash-star.svg"}))}),f=a(10),h=a(25),g=a(26),v=a(27),E=a(28),p=a(29),b=a(30),y=(a(22),"https://ver-1000000.github.io/mangankyo/"),w="Mangankyo | \u4e07\u9854\u93e1",k="Ver1000000000",S="2rem",C=function(e){var t,a,n=e.already,l=e.scale,o=e.setScale,c=e.facingMode,i=e.floatButtonsVisibled,s=e.floatButtonsDownloadMode,u=e.download,d=e.setFacingMode,m=e.setFloatButtonsVisibled,C=e.setFloatButtonsDownloadMode,M=e.settingsVisibled,Y=e.setSettingsVisibled,O=r.a.useRef(null),N=r.a.useRef(null),j=r.a.useCallback(function(e,t){return function(){t("user"===e?"environment":"user")}}(c,d),[c]);return r.a.useEffect(function(e,t){return function(){var a=function(a){27===a.keyCode&&(a.preventDefault(),t(!e))};return document.addEventListener("keydown",a),function(){return document.removeEventListener("keydown",a)}}}(M,Y),[M,Y]),r.a.useEffect(function(e,t){return function(){if(null!=t.current)return f.a.registerDialog(t.current),e&&!t.current.open?t.current.showModal():!e&&t.current.open&&t.current.close(),function(){}}}(M,O),[M,O,n]),n?r.a.createElement(r.a.Fragment,null,r.a.createElement("dialog",{className:"Settings-dialog",ref:O,onClick:function(){return Y(!1)},style:{backgroundImage:"url(./splash-star.svg)"}},r.a.createElement("section",{onClick:function(e){return e.stopPropagation()}},r.a.createElement("h2",null,"\u8a2d\u5b9a"),r.a.createElement("dl",null,r.a.createElement("dt",null,"\u30d1\u30bf\u30fc\u30f3\u306e\u5927\u304d\u3055"),r.a.createElement("dd",null,r.a.createElement("output",null,null!==(t=null===(a=N.current)||void 0===a?void 0:a.value)&&void 0!==t?t:0)),r.a.createElement("dd",null,r.a.createElement("input",{type:"range",step:"0.1",min:"0.1",max:"2.0",defaultValue:l,ref:N})),r.a.createElement("dd",null,r.a.createElement("button",{type:"button",className:"button",onClick:function(){var e;return o((null===(e=N.current)||void 0===e?void 0:e.valueAsNumber)||.5)}},"\u9069\u7528\u3059\u308b"))),r.a.createElement("dl",null,r.a.createElement("dt",null,"\u30d5\u30ed\u30f3\u30c8\u30ab\u30e1\u30e9 / \u30ea\u30a2\u30ab\u30e1\u30e9"),r.a.createElement("dd",null,r.a.createElement("small",null,"\u203b \u30c7\u30d0\u30a4\u30b9\u304c\u8a8d\u8b58\u3067\u304d\u306a\u3044\u5834\u5408\u306f\u5207\u308a\u66ff\u308f\u308a\u307e\u305b\u3093\u3002"),r.a.createElement("button",{type:"button",className:"button",onClick:j},"\u5207\u308a\u66ff\u3048\u308b"))),r.a.createElement("dl",null,r.a.createElement("dt",null,"\u30dc\u30bf\u30f3\u306e\u8868\u793a / \u975e\u8868\u793a"),r.a.createElement("dd",null,r.a.createElement("small",null,"\u203b \u30dc\u30bf\u30f3\u304c\u975e\u8868\u793a\u306e\u6642\u3001\u30ad\u30e3\u30f3\u30d0\u30b9\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u8a2d\u5b9a\u753b\u9762\u304c\u958b\u304d\u307e\u3059\u3002"),r.a.createElement("button",{type:"button",className:"button",onClick:function(){return m(!i)}},"\u30dc\u30bf\u30f3\u3092",i?"\u975e\u8868\u793a\u306b\u3059\u308b":"\u8868\u793a\u3059\u308b"))),function(){if(i)return r.a.createElement("dl",null,r.a.createElement("dt",null,"\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u30dc\u30bf\u30f3",r.a.createElement("img",{src:"./button-download.svg",className:"Settings-download-img",alt:""}),"\u306e\u30e2\u30fc\u30c9"),r.a.createElement("dd",null,r.a.createElement("small",null,"\u203b \u73fe\u5728\u306f [","display"===s?"\u753b\u9762\u5168\u4f53":"\u6700\u5c0f\u30d1\u30bf\u30fc\u30f3","\u30e2\u30fc\u30c9] \u3067\u3059\u3002"),r.a.createElement("button",{type:"button",className:"button",onClick:function(){return C("display"===s?"pattern":"display")}},"[","display"===s?"\u6700\u5c0f\u30d1\u30bf\u30fc\u30f3":"\u753b\u9762\u5168\u4f53","\u30e2\u30fc\u30c9] \u306b\u3059\u308b")))}()),r.a.createElement("section",{onClick:function(e){return e.stopPropagation()}},r.a.createElement("h2",null,"\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9"),r.a.createElement("dl",null,r.a.createElement("dt",null,"\u8868\u793a\u3055\u308c\u3066\u3044\u308b\u30ad\u30e3\u30f3\u30d0\u30b9\u753b\u50cf\u3092\u4fdd\u5b58"),r.a.createElement("dd",null,r.a.createElement("button",{type:"button",className:"button",onClick:function(){return u({mode:"display"})}},"\u753b\u9762\u5168\u4f53")),r.a.createElement("dd",null,r.a.createElement("button",{type:"button",className:"button",onClick:function(){return u({mode:"pattern"})}},"\u6700\u5c0f\u30d1\u30bf\u30fc\u30f3")))),r.a.createElement("section",{onClick:function(e){return e.stopPropagation()}},r.a.createElement("h2",null,"\u4e07\u9854\u93e1\u306b\u3064\u3044\u3066"),r.a.createElement("dl",null,r.a.createElement("dt",null,"Source on GitHub"),r.a.createElement("dd",null,r.a.createElement("a",{href:"https://github.com/ver-1000000/mangankyo"},"mangankyo"))),r.a.createElement("dl",null,r.a.createElement("dt",null,"WebSite / Author"),r.a.createElement("dd",null,r.a.createElement("a",{href:"https://ver1000000.com"},"Ver.1000000")," / ",r.a.createElement("a",{href:"https://twitter.com/Ver1000000000"},"@Ver1000000000")))),r.a.createElement("section",{onClick:function(e){return e.stopPropagation()}},r.a.createElement("h2",null,"SNS\u3067\u5171\u6709"),r.a.createElement("dl",null,r.a.createElement("dd",{className:"Settings-shareButton-container"},r.a.createElement(h.a,{url:y},r.a.createElement(g.a,{size:S})),r.a.createElement(v.a,{url:y,title:w,via:k},r.a.createElement(E.a,{size:S})),r.a.createElement(p.a,{url:y,title:w},r.a.createElement(b.a,{size:S}))))),r.a.createElement("footer",{className:"Settings-footer",onClick:function(e){return e.stopPropagation()}},r.a.createElement("button",{type:"button",className:"button sky",onClick:function(){return Y(!1)}},"close")))):null};function M(e){if(null==e)throw alert("\u30ec\u30f3\u30c0\u30ea\u30f3\u30b0\u30a8\u30e9\u30fc: \u30da\u30fc\u30b8\u3092\u518d\u8aad\u8fbc\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),new Error("Expected 'val' to be defined, but received ".concat(e))}var Y=function(e){return e instanceof OverconstrainedError?alert("".concat(e.name,":\n\u8981\u6c42\u3055\u308c\u305f\u30c7\u30d0\u30a4\u30b9\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3002\n\u8a2d\u5b9a\u3092\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002")):alert("".concat(e.name,":\n").concat(e.message)),null},O=function(e){return e*Math.PI/180},N=function(e){var t=e.width,a=e.height,n=Object.assign(document.createElement("canvas"),{width:t,height:a}),r=n.getContext("2d");return[n,r]},j=function(e,t){var a=t.scale,n=Math.min(e.videoWidth,e.videoHeight)*a,r=n/2*Math.tan(O(60)),l=N({width:n,height:r}),o=Object(u.a)(l,2),c=o[0],i=o[1],s=[{x:n/2,y:0},{x:n,y:r},{x:0,y:r}],d=-Math.max(0,(e.videoWidth-e.videoHeight)/2),m=-Math.max(0,(e.videoHeight-e.videoWidth)/2);return i.save(),i.scale(a,a),i.drawImage(e,d,m,e.videoWidth,e.videoHeight),i.restore(),i.globalCompositeOperation="destination-in",i.beginPath(),i.moveTo(s[0].x,s[0].y),i.lineTo(s[1].x,s[1].y),i.lineTo(s[2].x,s[2].y),i.closePath(),i.fill(),i.globalCompositeOperation="source-over",c},B=function(e,t){var a=N({width:3*e.width,height:2*e.height}),n=Object(u.a)(a,2),r=n[0],l=n[1],o=function(t){var a=t.rotate,n=void 0===a?0:a,o=t.scaleY,c=void 0===o?1:o,i=t.translateX,s=void 0===i?0:i,u=t.translateY,d=void 0===u?0:u;l.setTransform(1,0,0,1,r.width/3,r.height/2),l.rotate(O(n)),l.scale(1,c),l.translate(s,d),l.drawImage(e,-r.width/3,-r.height/2)};return o({rotate:0,scaleY:1}),o({rotate:0,scaleY:-1}),o({rotate:0,scaleY:1,translateX:1.5*e.width,translateY:e.height}),o({rotate:0,scaleY:-1,translateX:1.5*e.width,translateY:e.height}),o({rotate:120,scaleY:1}),o({rotate:120,scaleY:-1}),o({rotate:120,scaleY:1,translateX:0,translateY:2*-e.height}),o({rotate:120,scaleY:-1,translateX:0,translateY:2*e.height}),o({rotate:120,scaleY:1,translateX:1.5*e.width,translateY:e.height}),o({rotate:240,scaleY:1}),o({rotate:240,scaleY:-1}),o({rotate:240,scaleY:1,translateX:0,translateY:2*e.height}),o({rotate:240,scaleY:-1,translateX:0,translateY:2*-e.height}),o({rotate:240,scaleY:-1,translateX:1.5*e.width,translateY:e.height}),t(r),l.createPattern(l.canvas,"repeat")},x=function(){var e=Object(s.a)(i.a.mark((function e(t,a){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.srcObject instanceof MediaStream&&t.srcObject.getTracks().forEach((function(e){return e.stop()})),e.abrupt("return",navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:a}}).catch(Y));case 2:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),V=function(){var e=Object(s.a)(i.a.mark((function e(t,a){var n,r,l,o,c,s,u,d,m,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.canvas,r=a.scale,l=a.facingMode,o=a.setPatternCanvas,c=a.setAlready,M(n),e.next=4,x(t,l);case 4:return t.srcObject=e.sent,s=n.getContext("2d"),u=n.getBoundingClientRect(),d=u.width,m=u.height,Object.assign(n,{width:d,height:m}),f=function e(){var a=j(t,{scale:r});s.fillStyle=B(a,o),s.fillRect(0,0,d,m),t.paused||requestAnimationFrame(e)},e.next=11,t.play().then((function(){return f()})).then((function(){return c(!0)}));case 11:return e.abrupt("return",t.srcObject);case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),P=function(e,t){return function(a){M(e.current),M(t);var n="display"===a.mode?e.current:t,r=n.width,l=n.height,o=N({width:r,height:l}),c=Object(u.a)(o,2),i=c[0];c[1].drawImage(e.current,0,0);var s=document.createElement("a"),d=document.createElement("img");document.body.appendChild(s),document.body.appendChild(d),s.href=d.src=i.toDataURL(),s.download="mangankyo_".concat((new Date).toLocaleString("ja-JP",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"numeric"}).replace(/\D/g,""),".png"),s.click(),s.remove(),d.remove()}},D=function(){var e=document.createElement("video");return["playsinline","muted","autoplay"].forEach((function(t){return e.setAttribute(t,"")})),e}(),F=function(){var e=r.a.useState(!1),t=Object(u.a)(e,2),a=t[0],n=t[1],l=r.a.useState(!0),o=Object(u.a)(l,2),c=o[0],i=o[1],s=r.a.useState("display"),f=Object(u.a)(s,2),h=f[0],g=f[1],v=r.a.useState(!1),E=Object(u.a)(v,2),p=E[0],b=E[1],y=r.a.useState("user"),w=Object(u.a)(y,2),k=w[0],S=w[1],M=r.a.useState(.5),O=Object(u.a)(M,2),N=O[0],j=O[1],B=r.a.useState(null),x=Object(u.a)(B,2),F=x[0],A=x[1],R=r.a.useRef(null),X=r.a.useCallback(P(R,F),[F]),W=D;return r.a.useEffect(function(e){var t=e.video,a=e.canvasRef,n=e.scale,r=e.facingMode,l=e.setPatternCanvas,o=e.setAlready;return function(){var e;if("function"===typeof(null===(e=navigator.mediaDevices)||void 0===e?void 0:e.getUserMedia)){var c=V(t,{video:t,canvas:a.current,scale:n,facingMode:r,setPatternCanvas:l,setAlready:o});return function(){o(!1),c.then((function(){return t.paused||t.pause()})).then((function(){return o(!0)}))}}Y(new Error("\u304a\u4f7f\u3044\u306e\u30d6\u30e9\u30a6\u30b6\u306fgetUserMedia()\u306b\u672a\u5bfe\u5fdc\u3067\u3059\u3002\n\u4ed6\u306e\u30d6\u30e9\u30a6\u30b6\u3092\u3054\u5229\u7528\u304f\u3060\u3055\u3044\u3002"))}}({video:W,canvasRef:R,scale:N,facingMode:k,setPatternCanvas:A,setAlready:n}),[R,N,k]),r.a.createElement(r.a.Fragment,null,r.a.createElement("canvas",{ref:R,className:"App-canvas",style:{pointerEvents:c?"none":"auto"},onClick:function(){return b(!0)}}),r.a.createElement(m,{already:a}),r.a.createElement(d,{already:a,floatButtonsVisibled:c,floatButtonsDownloadMode:h,download:X,setSettingsVisibled:b}),r.a.createElement(C,{already:a,scale:N,facingMode:k,floatButtonsVisibled:c,floatButtonsDownloadMode:h,download:X,setScale:j,setFacingMode:S,settingsVisibled:p,setSettingsVisibled:b,setFloatButtonsVisibled:i,setFloatButtonsDownloadMode:g}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(F,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[12,1,2]]]);
//# sourceMappingURL=main.4889c2a7.chunk.js.map